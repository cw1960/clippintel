"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "appComponentFetch", {
    enumerable: true,
    get: function() {
        return appComponentFetch;
    }
});
function appComponentFetch({ component, path, token, allowDefaultNextJsCache, customFetcher, ...rest }) {
    const { isClient: isClientParam, headers: headersInput, ...requestInit } = rest;
    const isClient = isClientParam ?? typeof window !== "undefined";
    const url = isClient ? `/_whop/${component}${path}` : `https://${component}.api.whop.com${path}`;
    const h = new Headers(typeof headersInput === "function" ? headersInput() : headersInput);
    const headers = isClient ? h : new Headers();
    if (!isClient) {
        copyHeaders([
            "authorization",
            "cookie"
        ], h, headers);
    }
    if (token) {
        headers.set("authorization", `Bearer ${token}`);
    }
    const nextJsNoCacheOptions = allowDefaultNextJsCache ? {} : {
        cache: "no-store"
    };
    const opts = {
        ...nextJsNoCacheOptions,
        ...requestInit,
        headers
    };
    return customFetcher ? customFetcher.fetch(url, opts) : fetch(url, opts);
}
function copyHeaders(names, from, to) {
    for (const name of names){
        const value = from.get(name);
        if (value) {
            to.set(name, value);
        }
    }
}
